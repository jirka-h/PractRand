#include <ctime>
#include <cstdio>
#include <string>
#include <vector>
#include <cmath>
#include <cstring>
#include <cstdlib>

#include "PractRand/config.h"
#include "PractRand/rng_basics.h"
#include "PractRand/rng_helpers.h"
#include "PractRand/rng_internals.h"

#include "PractRand/test_helpers.h"//remove me

//for use in seeding & self-tests:
#include "PractRand/RNGs/all.h"

/*
	currently the only non-uniform distribution supported is the Gaussian distribution
*/

namespace PractRand {
	namespace Internals {


		/*
			Gaussian/Normal distribution implementation

			Rolled my own.  
			Possibly a standard Ziggaraut method would work better, but this is simple and it works and it can be replaced later. 
			I suppose this does have the merit of using a fixed number of input bits.  
			Unfortunately, this breaks at the tails.  This won't produce any events more than about 6 standard deviations from the mean.
			Still, it's fast, simple, and doesn't have any real exotic cases - there's no "only do this one in 80 times" complex code path.  

			At GAUSSIAN_CDF_TABLE_SIZE=1024 this needs 8 KB of memory.  I feel like that's too much.  
			It seems like a waste to spend 8 KB on something that many people will never use, but the linker may be smart enough to discard it.  
			I would try shrinking it down to 256 entries, but the size makes a big difference in quality for this approach

			I'm aiming for 25 or so bits of good resolution plus another 25 or so bits of noise here - 
			good enough to be practically impossible to distinguish from from true gaussian, and significantly better than single precision floats, but not quite maxing 
			out what double precision numbers can manage.  More than that and I would have have a hard time verifying things without large number types 
			and even more exotic math.  

		*/
		enum {GAUSSIAN_CDF_TABLE_SIZE_L2=10, GAUSSIAN_CDF_TABLE_SIZE = 1 << GAUSSIAN_CDF_TABLE_SIZE_L2};
		static const float primary_gaussian_cdf_table[GAUSSIAN_CDF_TABLE_SIZE] = {
			-1.90363550, -1.71762908, -1.62504756, -1.56157815, -1.51274538, -1.47280645, -1.43887460, -1.40928662, -1.38299346, -1.35928977, -1.33767736, -1.31779122, -1.29935551, -1.28215671, -1.26602554, -1.25082600, -1.23644698, -1.22279632, -1.20979691, -1.19738328, -1.18549967, -1.17409813, -1.16313684, -1.15257943, -1.14239395, -1.13255203, -1.12302864, -1.11380136, -1.10485005, -1.09615684, -1.08770514, -1.07948029,
			-1.07146895, -1.06365871, -1.05603838, -1.04859769, -1.04132724, -1.03421831, -1.02726269, -1.02045310, -1.01378262, -1.00724471, -1.00083351, -0.99454343, -0.98836917, -0.98230594, -0.97634917, -0.97049451, -0.96473801, -0.95907587, -0.95350444, -0.94802046, -0.94262069, -0.93730217, -0.93206197, -0.92689747, -0.92180610, -0.91678536, -0.91183305, -0.90694696, -0.90212494, -0.89736509, -0.89266539, -0.88802415,
			-0.88343960, -0.87891006, -0.87443405, -0.87000990, -0.86563629, -0.86131179, -0.85703510, -0.85280496, -0.84862006, -0.84447926, -0.84038150, -0.83632559, -0.83231056, -0.82833540, -0.82439911, -0.82050079, -0.81663948, -0.81281441, -0.80902463, -0.80526942, -0.80154800, -0.79785955, -0.79420340, -0.79057878, -0.78698510, -0.78342164, -0.77988780, -0.77638292, -0.77290642, -0.76945770, -0.76603627, -0.76264149,
			-0.75927287, -0.75592995, -0.75261211, -0.74931902, -0.74605006, -0.74280488, -0.73958302, -0.73638397, -0.73320740, -0.73005289, -0.72692001, -0.72380835, -0.72071761, -0.71764737, -0.71459734, -0.71156710, -0.70855629, -0.70556468, -0.70259190, -0.69963759, -0.69670153, -0.69378334, -0.69088280, -0.68799955, -0.68513340, -0.68228400, -0.67945117, -0.67663455, -0.67383397, -0.67104918, -0.66827989, -0.66552585,
			-0.66278690, -0.66006279, -0.65735334, -0.65465826, -0.65197736, -0.64931041, -0.64665729, -0.64401776, -0.64139158, -0.63877863, -0.63617873, -0.63359165, -0.63101721, -0.62845528, -0.62590563, -0.62336814, -0.62084264, -0.61832899, -0.61582696, -0.61333644, -0.61085731, -0.60838938, -0.60593253, -0.60348660, -0.60105145, -0.59862697, -0.59621298, -0.59380937, -0.59141600, -0.58903277, -0.58665949, -0.58429611,
			-0.58194250, -0.57959849, -0.57726401, -0.57493895, -0.57262313, -0.57031649, -0.56801897, -0.56573039, -0.56345063, -0.56117964, -0.55891734, -0.55666351, -0.55441821, -0.55218124, -0.54995251, -0.54773194, -0.54551947, -0.54331493, -0.54111838, -0.53892958, -0.53674847, -0.53457505, -0.53240913, -0.53025067, -0.52809966, -0.52595592, -0.52381939, -0.52169001, -0.51956773, -0.51745242, -0.51534402, -0.51324254,
			-0.51114780, -0.50905973, -0.50697833, -0.50490350, -0.50283515, -0.50077325, -0.49871776, -0.49666852, -0.49462551, -0.49258870, -0.49055800, -0.48853335, -0.48651469, -0.48450196, -0.48249510, -0.48049405, -0.47849876, -0.47650915, -0.47452521, -0.47254685, -0.47057399, -0.46860665, -0.46664473, -0.46468818, -0.46273693, -0.46079099, -0.45885023, -0.45691469, -0.45498422, -0.45305887, -0.45113853, -0.44922313,
			-0.44731271, -0.44540715, -0.44350645, -0.44161052, -0.43971935, -0.43783289, -0.43595108, -0.43407393, -0.43220133, -0.43033326, -0.42846969, -0.42661056, -0.42475587, -0.42290553, -0.42105952, -0.41921782, -0.41738039, -0.41554716, -0.41371810, -0.41189319, -0.41007239, -0.40825567, -0.40644297, -0.40463427, -0.40282953, -0.40102872, -0.39923179, -0.39743873, -0.39564952, -0.39386407, -0.39208239, -0.39030442,
			-0.38853016, -0.38675958, -0.38499260, -0.38322923, -0.38146943, -0.37971315, -0.37796038, -0.37621111, -0.37446526, -0.37272286, -0.37098381, -0.36924815, -0.36751580, -0.36578676, -0.36406100, -0.36233848, -0.36061919, -0.35890308, -0.35719013, -0.35548034, -0.35377365, -0.35207003, -0.35036948, -0.34867197, -0.34697747, -0.34528595, -0.34359741, -0.34191176, -0.34022906, -0.33854923, -0.33687225, -0.33519813,
			-0.33352679, -0.33185828, -0.33019251, -0.32852948, -0.32686919, -0.32521158, -0.32355666, -0.32190442, -0.32025477, -0.31860775, -0.31696332, -0.31532145, -0.31368211, -0.31204534, -0.31041104, -0.30877921, -0.30714986, -0.30552298, -0.30389848, -0.30227640, -0.30065671, -0.29903936, -0.29742438, -0.29581171, -0.29420134, -0.29259327, -0.29098746, -0.28938389, -0.28778258, -0.28618345, -0.28458652, -0.28299177,
			-0.28139916, -0.27980870, -0.27822036, -0.27663413, -0.27504998, -0.27346790, -0.27188784, -0.27030987, -0.26873386, -0.26715988, -0.26558790, -0.26401785, -0.26244977, -0.26088363, -0.25931939, -0.25775707, -0.25619662, -0.25463805, -0.25308132, -0.25152642, -0.24997336, -0.24842210, -0.24687263, -0.24532495, -0.24377902, -0.24223484, -0.24069239, -0.23915166, -0.23761262, -0.23607527, -0.23453960, -0.23300557,
			-0.23147321, -0.22994246, -0.22841333, -0.22688580, -0.22535984, -0.22383548, -0.22231266, -0.22079140, -0.21927166, -0.21775344, -0.21623673, -0.21472150, -0.21320775, -0.21169548, -0.21018465, -0.20867525, -0.20716728, -0.20566073, -0.20415556, -0.20265180, -0.20114940, -0.19964837, -0.19814868, -0.19665033, -0.19515330, -0.19365758, -0.19216315, -0.19067003, -0.18917817, -0.18768758, -0.18619822, -0.18471012,
			-0.18322323, -0.18173757, -0.18025310, -0.17876983, -0.17728773, -0.17580681, -0.17432703, -0.17284840, -0.17137089, -0.16989453, -0.16841926, -0.16694510, -0.16547202, -0.16400002, -0.16252908, -0.16105920, -0.15959036, -0.15812255, -0.15665577, -0.15518999, -0.15372522, -0.15226144, -0.15079862, -0.14933679, -0.14787591, -0.14641596, -0.14495696, -0.14349888, -0.14204171, -0.14058545, -0.13913010, -0.13767561,
			-0.13622200, -0.13476926, -0.13331737, -0.13186632, -0.13041611, -0.12896670, -0.12751813, -0.12607035, -0.12462336, -0.12317716, -0.12173172, -0.12028705, -0.11884313, -0.11739996, -0.11595752, -0.11451580, -0.11307479, -0.11163449, -0.11019489, -0.10875597, -0.10731772, -0.10588014, -0.10444322, -0.10300694, -0.10157131, -0.10013629, -0.09870189, -0.09726811, -0.09583493, -0.09440233, -0.09297032, -0.09153888,
			-0.09010799, -0.08867767, -0.08724789, -0.08581864, -0.08438992, -0.08296172, -0.08153401, -0.08010682, -0.07868011, -0.07725388, -0.07582812, -0.07440282, -0.07297798, -0.07155358, -0.07012962, -0.06870608, -0.06728296, -0.06586025, -0.06443794, -0.06301602, -0.06159448, -0.06017332, -0.05875252, -0.05733208, -0.05591198, -0.05449222, -0.05307279, -0.05165368, -0.05023488, -0.04881639, -0.04739819, -0.04598028,
			-0.04456265, -0.04314528, -0.04172817, -0.04031131, -0.03889470, -0.03747832, -0.03606217, -0.03464623, -0.03323051, -0.03181498, -0.03039964, -0.02898449, -0.02756951, -0.02615469, -0.02474003, -0.02332553, -0.02191116, -0.02049692, -0.01908280, -0.01766880, -0.01625491, -0.01484111, -0.01342741, -0.01201378, -0.01060022, -0.00918673, -0.00777330, -0.00635991, -0.00494655, -0.00353323, -0.00211993, -0.00070664,
			+0.00070664, +0.00211993, +0.00353323, +0.00494655, +0.00635991, +0.00777330, +0.00918673, +0.01060022, +0.01201378, +0.01342741, +0.01484111, +0.01625491, +0.01766880, +0.01908280, +0.02049692, +0.02191116, +0.02332553, +0.02474003, +0.02615469, +0.02756951, +0.02898449, +0.03039964, +0.03181498, +0.03323051, +0.03464623, +0.03606217, +0.03747832, +0.03889470, +0.04031131, +0.04172817, +0.04314528, +0.04456265,
			+0.04598028, +0.04739819, +0.04881639, +0.05023488, +0.05165368, +0.05307279, +0.05449222, +0.05591198, +0.05733208, +0.05875252, +0.06017332, +0.06159448, +0.06301602, +0.06443794, +0.06586025, +0.06728296, +0.06870608, +0.07012962, +0.07155358, +0.07297798, +0.07440282, +0.07582812, +0.07725388, +0.07868011, +0.08010682, +0.08153401, +0.08296172, +0.08438992, +0.08581864, +0.08724789, +0.08867767, +0.09010799,
			+0.09153888, +0.09297032, +0.09440233, +0.09583493, +0.09726811, +0.09870189, +0.10013629, +0.10157131, +0.10300694, +0.10444322, +0.10588014, +0.10731772, +0.10875597, +0.11019489, +0.11163449, +0.11307479, +0.11451580, +0.11595752, +0.11739996, +0.11884313, +0.12028705, +0.12173172, +0.12317716, +0.12462336, +0.12607035, +0.12751813, +0.12896670, +0.13041611, +0.13186632, +0.13331737, +0.13476926, +0.13622200,
			+0.13767561, +0.13913010, +0.14058545, +0.14204171, +0.14349888, +0.14495696, +0.14641596, +0.14787591, +0.14933679, +0.15079862, +0.15226144, +0.15372522, +0.15518999, +0.15665577, +0.15812255, +0.15959036, +0.16105920, +0.16252908, +0.16400002, +0.16547202, +0.16694510, +0.16841926, +0.16989453, +0.17137089, +0.17284840, +0.17432703, +0.17580681, +0.17728773, +0.17876983, +0.18025310, +0.18173757, +0.18322323,
			+0.18471012, +0.18619822, +0.18768758, +0.18917817, +0.19067003, +0.19216315, +0.19365758, +0.19515330, +0.19665033, +0.19814868, +0.19964837, +0.20114940, +0.20265180, +0.20415556, +0.20566073, +0.20716728, +0.20867525, +0.21018465, +0.21169548, +0.21320775, +0.21472150, +0.21623673, +0.21775344, +0.21927166, +0.22079140, +0.22231266, +0.22383548, +0.22535984, +0.22688580, +0.22841333, +0.22994246, +0.23147321,
			+0.23300557, +0.23453960, +0.23607527, +0.23761262, +0.23915166, +0.24069239, +0.24223484, +0.24377902, +0.24532495, +0.24687263, +0.24842210, +0.24997336, +0.25152642, +0.25308132, +0.25463805, +0.25619662, +0.25775707, +0.25931939, +0.26088363, +0.26244977, +0.26401785, +0.26558790, +0.26715988, +0.26873386, +0.27030987, +0.27188784, +0.27346790, +0.27504998, +0.27663413, +0.27822036, +0.27980870, +0.28139916,
			+0.28299177, +0.28458652, +0.28618345, +0.28778258, +0.28938389, +0.29098746, +0.29259327, +0.29420134, +0.29581171, +0.29742438, +0.29903936, +0.30065671, +0.30227640, +0.30389848, +0.30552298, +0.30714986, +0.30877921, +0.31041104, +0.31204534, +0.31368211, +0.31532145, +0.31696332, +0.31860775, +0.32025477, +0.32190442, +0.32355666, +0.32521158, +0.32686919, +0.32852948, +0.33019251, +0.33185828, +0.33352679,
			+0.33519813, +0.33687225, +0.33854923, +0.34022906, +0.34191176, +0.34359741, +0.34528595, +0.34697747, +0.34867197, +0.35036948, +0.35207003, +0.35377365, +0.35548034, +0.35719013, +0.35890308, +0.36061919, +0.36233848, +0.36406100, +0.36578676, +0.36751580, +0.36924815, +0.37098381, +0.37272286, +0.37446526, +0.37621111, +0.37796038, +0.37971315, +0.38146943, +0.38322923, +0.38499260, +0.38675958, +0.38853016,
			+0.39030442, +0.39208239, +0.39386407, +0.39564952, +0.39743873, +0.39923179, +0.40102872, +0.40282953, +0.40463427, +0.40644297, +0.40825567, +0.41007239, +0.41189319, +0.41371810, +0.41554716, +0.41738039, +0.41921782, +0.42105952, +0.42290553, +0.42475587, +0.42661056, +0.42846969, +0.43033326, +0.43220133, +0.43407393, +0.43595108, +0.43783289, +0.43971935, +0.44161052, +0.44350645, +0.44540715, +0.44731271,
			+0.44922313, +0.45113853, +0.45305887, +0.45498422, +0.45691469, +0.45885023, +0.46079099, +0.46273693, +0.46468818, +0.46664473, +0.46860665, +0.47057399, +0.47254685, +0.47452521, +0.47650915, +0.47849876, +0.48049405, +0.48249510, +0.48450196, +0.48651469, +0.48853335, +0.49055800, +0.49258870, +0.49462551, +0.49666852, +0.49871776, +0.50077325, +0.50283515, +0.50490350, +0.50697833, +0.50905973, +0.51114780,
			+0.51324254, +0.51534402, +0.51745242, +0.51956773, +0.52169001, +0.52381939, +0.52595592, +0.52809966, +0.53025067, +0.53240913, +0.53457505, +0.53674847, +0.53892958, +0.54111838, +0.54331493, +0.54551947, +0.54773194, +0.54995251, +0.55218124, +0.55441821, +0.55666351, +0.55891734, +0.56117964, +0.56345063, +0.56573039, +0.56801897, +0.57031649, +0.57262313, +0.57493895, +0.57726401, +0.57959849, +0.58194250,
			+0.58429611, +0.58665949, +0.58903277, +0.59141600, +0.59380937, +0.59621298, +0.59862697, +0.60105145, +0.60348660, +0.60593253, +0.60838938, +0.61085731, +0.61333644, +0.61582696, +0.61832899, +0.62084264, +0.62336814, +0.62590563, +0.62845528, +0.63101721, +0.63359165, +0.63617873, +0.63877863, +0.64139158, +0.64401776, +0.64665729, +0.64931041, +0.65197736, +0.65465826, +0.65735334, +0.66006279, +0.66278690,
			+0.66552585, +0.66827989, +0.67104918, +0.67383397, +0.67663455, +0.67945117, +0.68228400, +0.68513340, +0.68799955, +0.69088280, +0.69378334, +0.69670153, +0.69963759, +0.70259190, +0.70556468, +0.70855629, +0.71156710, +0.71459734, +0.71764737, +0.72071761, +0.72380835, +0.72692001, +0.73005289, +0.73320740, +0.73638397, +0.73958302, +0.74280488, +0.74605006, +0.74931902, +0.75261211, +0.75592995, +0.75927287,
			+0.76264149, +0.76603627, +0.76945770, +0.77290642, +0.77638292, +0.77988780, +0.78342164, +0.78698510, +0.79057878, +0.79420340, +0.79785955, +0.80154800, +0.80526942, +0.80902463, +0.81281441, +0.81663948, +0.82050079, +0.82439911, +0.82833540, +0.83231056, +0.83632559, +0.84038150, +0.84447926, +0.84862006, +0.85280496, +0.85703510, +0.86131179, +0.86563629, +0.87000990, +0.87443405, +0.87891006, +0.88343960,
			+0.88802415, +0.89266539, +0.89736509, +0.90212494, +0.90694696, +0.91183305, +0.91678536, +0.92180610, +0.92689747, +0.93206197, +0.93730217, +0.94262069, +0.94802046, +0.95350444, +0.95907587, +0.96473801, +0.97049451, +0.97634917, +0.98230594, +0.98836917, +0.99454343, +1.00083351, +1.00724471, +1.01378262, +1.02045310, +1.02726269, +1.03421831, +1.04132724, +1.04859769, +1.05603838, +1.06365871, +1.07146895,
			+1.07948029, +1.08770514, +1.09615684, +1.10485005, +1.11380136, +1.12302864, +1.13255203, +1.14239395, +1.15257943, +1.16313684, +1.17409813, +1.18549967, +1.19738328, +1.20979691, +1.22279632, +1.23644698, +1.25082600, +1.26602554, +1.28215671, +1.29935551, +1.31779122, +1.33767736, +1.35928977, +1.38299346, +1.40928662, +1.43887460, +1.47280645, +1.51274538, +1.56157815, +1.62504756, +1.71762908, +1.90363550
		};
		static const float secondary_gaussian_cdf_table[GAUSSIAN_CDF_TABLE_SIZE] = {
			+5.3749574e-011, +2.8448887e-011, +1.7486793e-011, +1.2835072e-011, +1.0222725e-011, +8.5383107e-012, +7.3572485e-012, +6.480874e-012 , +5.8034172e-012, +5.2632386e-012, +4.8219189e-012, +4.4542326e-012, +4.1429152e-012, +3.8757404e-012, +3.6438027e-012, +3.4404563e-012, +3.2606389e-012, +3.1004255e-012, +2.9567238e-012, +2.8270645e-012, +2.7094505e-012, +2.6022494e-012, +2.504113e-012 , +2.4139185e-012, +2.3307229e-012, +2.2537256e-012, +2.182249e-012 , +2.1157076e-012, +2.0535984e-012, +1.9954845e-012, +1.9409858e-012, +1.8897685e-012,
			+1.8415397e-012, +1.7960404e-012, +1.753041e-012 , +1.7123369e-012, +1.6737457e-012, +1.6371041e-012, +1.6022651e-012, +1.5690964e-012, +1.5374785e-012, +1.5073031e-012, +1.4784716e-012, +1.4508949e-012, +1.424491e-012 , +1.3991852e-012, +1.3749093e-012, +1.3516005e-012, +1.329201e-012 , +1.3076575e-012, +1.2869212e-012, +1.2669466e-012, +1.2476918e-012, +1.2291178e-012, +1.2111886e-012, +1.1938704e-012, +1.1771321e-012, +1.1609444e-012, +1.1452803e-012, +1.130114e-012 , +1.1154221e-012, +1.1011822e-012, +1.0873732e-012, +1.0739759e-012,
			+1.0609715e-012, +1.0483427e-012, +1.0360735e-012, +1.0241481e-012, +1.0125523e-012, +1.0012724e-012, +9.902953e-013 , +9.7960897e-013, +9.6920161e-013, +9.5906247e-013, +9.4918116e-013, +9.395477e-013 , +9.3015276e-013, +9.2098757e-013, +9.1204355e-013, +9.0331291e-013, +8.9478777e-013, +8.8646094e-013, +8.7832557e-013, +8.7037495e-013, +8.626028e-013 , +8.5500313e-013, +8.4757022e-013, +8.4029853e-013, +8.3318286e-013, +8.2621816e-013, +8.1939962e-013, +8.1272266e-013, +8.0618287e-013, +7.9977599e-013, +7.9349808e-013, +7.8734512e-013,
			+7.8131349e-013, +7.7539955e-013, +7.6959988e-013, +7.6391118e-013, +7.583303e-013 , +7.5285411e-013, +7.4747977e-013, +7.4220437e-013, +7.3702524e-013, +7.3193974e-013, +7.2694531e-013, +7.2203962e-013, +7.1722023e-013, +7.1248487e-013, +7.0783136e-013, +7.0325766e-013, +6.9876169e-013, +6.943415e-013 , +6.8999515e-013, +6.8572085e-013, +6.815168e-013 , +6.7738127e-013, +6.7331264e-013, +6.6930928e-013, +6.6536961e-013, +6.6149224e-013, +6.5767557e-013, +6.5391827e-013, +6.5021892e-013, +6.4657627e-013, +6.4298903e-013, +6.3945588e-013,
			+6.359757e-013 , +6.3254724e-013, +6.2916941e-013, +6.2584112e-013, +6.2256125e-013, +6.1932881e-013, +6.1614277e-013, +6.1300222e-013, +6.0990606e-013, +6.0685349e-013, +6.0384353e-013, +6.0087536e-013, +5.9794812e-013, +5.95061e-013  , +5.9221318e-013, +5.8940385e-013, +5.8663231e-013, +5.8389773e-013, +5.8119948e-013, +5.7853678e-013, +5.75909e-013 , +5.7331548e-013 , +5.7075552e-013, +5.6822857e-013, +5.6573393e-013, +5.63271e-013  , +5.6083924e-013, +5.5843812e-013, +5.5606697e-013, +5.5372531e-013, +5.5141265e-013, +5.491284e-013 ,
			+5.4687206e-013, +5.4464322e-013, +5.4244131e-013, +5.4026586e-013, +5.3811648e-013, +5.3599269e-013, +5.3389406e-013, +5.3182019e-013, +5.2977056e-013, +5.2774489e-013, +5.257427e-013 , +5.237636e-013 , +5.2180726e-013, +5.1987332e-013, +5.1796132e-013, +5.1607102e-013, +5.1420196e-013, +5.1235389e-013, +5.1052646e-013, +5.0871931e-013, +5.0693217e-013, +5.051647e-013 , +5.0341659e-013, +5.016875e-013 , +4.9997723e-013, +4.9828544e-013, +4.9661187e-013, +4.9495624e-013, +4.9331828e-013, +4.9169772e-013, +4.9009435e-013, +4.8850783e-013,
			+4.8693796e-013, +4.8538446e-013, +4.8384717e-013, +4.8232582e-013, +4.8082019e-013, +4.7933001e-013, +4.7785511e-013, +4.7639529e-013, +4.7495027e-013, +4.7351988e-013, +4.7210396e-013, +4.7070225e-013, +4.6931458e-013, +4.6794074e-013, +4.6658055e-013, +4.6523386e-013, +4.6390046e-013, +4.6258017e-013, +4.6127278e-013, +4.5997819e-013, +4.5869623e-013, +4.5742669e-013, +4.5616939e-013, +4.5492424e-013, +4.5369107e-013, +4.5246969e-013, +4.5125996e-013, +4.5006175e-013, +4.4887491e-013, +4.4769928e-013, +4.4653471e-013, +4.4538112e-013,
			+4.4423831e-013, +4.4310622e-013, +4.4198464e-013, +4.4087349e-013, +4.3977262e-013, +4.3868194e-013, +4.3760129e-013, +4.3653056e-013, +4.3546964e-013, +4.3441842e-013, +4.3337678e-013, +4.3234459e-013, +4.3132178e-013, +4.3030821e-013, +4.2930378e-013, +4.2830838e-013, +4.2732191e-013, +4.2634429e-013, +4.2537539e-013, +4.2441511e-013, +4.234634e-013 , +4.2252012e-013, +4.2158518e-013, +4.2065849e-013, +4.1973998e-013, +4.1882955e-013, +4.1792711e-013, +4.1703257e-013, +4.1614582e-013, +4.1526683e-013, +4.1439551e-013, +4.1353173e-013,
			+4.1267545e-013, +4.1182661e-013, +4.1098508e-013, +4.1015078e-013, +4.093237e-013 , +4.0850372e-013, +4.0769078e-013, +4.0688479e-013, +4.060857e-013 , +4.0529345e-013, +4.0450794e-013, +4.0372913e-013, +4.0295694e-013, +4.0219127e-013, +4.0143214e-013, +4.0067941e-013, +3.9993304e-013, +3.9919299e-013, +3.9845918e-013, +3.9773154e-013, +3.9701001e-013, +3.9629457e-013, +3.9558512e-013, +3.9488164e-013, +3.9418403e-013, +3.9349226e-013, +3.9280628e-013, +3.9212603e-013, +3.9145147e-013, +3.9078251e-013, +3.9011914e-013, +3.8946128e-013,
			+3.8880891e-013, +3.8816194e-013, +3.8752037e-013, +3.8688413e-013, +3.8625315e-013, +3.856274e-013 , +3.8500686e-013, +3.8439144e-013, +3.8378114e-013, +3.8317589e-013, +3.8257562e-013, +3.8198034e-013, +3.8138999e-013, +3.8080452e-013, +3.8022387e-013, +3.7964805e-013, +3.7907698e-013, +3.7851062e-013, +3.7794895e-013, +3.7739194e-013, +3.7683951e-013, +3.7629166e-013, +3.7574834e-013, +3.7520949e-013, +3.7467514e-013, +3.7414519e-013, +3.7361962e-013, +3.7309842e-013, +3.7258152e-013, +3.7206894e-013, +3.7156058e-013, +3.7105643e-013,
			+3.7055648e-013, +3.700607e-013 , +3.6956901e-013, +3.6908145e-013, +3.6859792e-013, +3.6811843e-013, +3.6764293e-013, +3.6717141e-013, +3.6670382e-013, +3.6624013e-013, +3.6578035e-013, +3.6532442e-013, +3.648723e-013 , +3.6442401e-013, +3.6397946e-013, +3.6353868e-013, +3.6310161e-013, +3.6266823e-013, +3.6223851e-013, +3.6181244e-013, +3.6138998e-013, +3.609711e-013 , +3.6055582e-013, +3.6014404e-013, +3.5973581e-013, +3.5933108e-013, +3.5892982e-013, +3.58532e-013  , +3.5813759e-013, +3.577466e-013 , +3.5735897e-013, +3.5697473e-013,
			+3.5659382e-013, +3.5621622e-013, +3.558419e-013 , +3.5547089e-013, +3.551031e-013 , +3.5473856e-013, +3.5437723e-013, +3.5401909e-013, +3.5366412e-013, +3.5331232e-013, +3.5296364e-013, +3.5261808e-013, +3.5227564e-013, +3.5193625e-013, +3.5159993e-013, +3.5126665e-013, +3.509364e-013 , +3.5060914e-013, +3.5028491e-013, +3.499636e-013 , +3.4964528e-013, +3.4932991e-013, +3.4901745e-013, +3.4870788e-013, +3.4840121e-013, +3.4809745e-013, +3.477965e-013 , +3.4749842e-013, +3.4720317e-013, +3.4691073e-013, +3.4662109e-013, +3.4633424e-013,
			+3.4605015e-013, +3.457688e-013 , +3.4549021e-013, +3.4521434e-013, +3.449412e-013 , +3.4467074e-013, +3.4440297e-013, +3.4413789e-013, +3.4387543e-013, +3.4361565e-013, +3.4335851e-013, +3.4310396e-013, +3.4285205e-013, +3.4260271e-013, +3.4235597e-013, +3.4211181e-013, +3.418702e-013 , +3.4163113e-013, +3.4139461e-013, +3.4116061e-013, +3.4092913e-013, +3.4070018e-013, +3.4047369e-013, +3.4024969e-013, +3.4002816e-013, +3.3980907e-013, +3.3959248e-013, +3.3937829e-013, +3.3916655e-013, +3.3895722e-013, +3.387503e-013 , +3.3854579e-013,
			+3.3834367e-013, +3.3814393e-013, +3.3794655e-013, +3.3775156e-013, +3.3755889e-013, +3.3736859e-013, +3.3718064e-013, +3.36995e-013 , +3.3681169e-013 , +3.3663068e-013, +3.3645198e-013, +3.3627555e-013, +3.3610143e-013, +3.3592961e-013, +3.3576004e-013, +3.3559272e-013, +3.3542768e-013, +3.3526486e-013, +3.3510431e-013, +3.3494599e-013, +3.3478989e-013, +3.3463599e-013, +3.3448434e-013, +3.3433488e-013, +3.3418762e-013, +3.3404255e-013, +3.3389968e-013, +3.3375898e-013, +3.3362045e-013, +3.3348408e-013, +3.3334991e-013, +3.3321786e-013,
			+3.3308797e-013, +3.3296022e-013, +3.3283462e-013, +3.3271115e-013, +3.325898e-013 , +3.324706e-013 , +3.323535e-013 , +3.3223852e-013, +3.3212563e-013, +3.3201485e-013, +3.3190616e-013, +3.3179958e-013, +3.3169509e-013, +3.3159266e-013, +3.3149235e-013, +3.3139409e-013, +3.312979e-013 , +3.3120379e-013, +3.3111171e-013, +3.3102172e-013, +3.3093377e-013, +3.3084787e-013, +3.3076403e-013, +3.3068223e-013, +3.3060249e-013, +3.3052475e-013, +3.3044907e-013, +3.303754e-013 , +3.3030379e-013, +3.3023419e-013, +3.3016659e-013, +3.3010102e-013,
			+3.3003748e-013, +3.2997593e-013, +3.2991641e-013, +3.2985889e-013, +3.2980338e-013, +3.2974987e-013, +3.2969837e-013, +3.2964885e-013, +3.2960134e-013, +3.2955583e-013, +3.295123e-013 , +3.2947077e-013, +3.2943123e-013, +3.2939366e-013, +3.293581e-013 , +3.2932449e-013, +3.2929288e-013, +3.2926326e-013, +3.2923564e-013, +3.2920997e-013, +3.2918628e-013, +3.2916457e-013, +3.2914483e-013, +3.2912708e-013, +3.291113e-013 , +3.2909751e-013, +3.2908566e-013, +3.290758e-013 , +3.2906791e-013, +3.29062e-013  , +3.2905804e-013, +3.2905609e-013,
			+3.2905609e-013, +3.2905804e-013, +3.29062e-013  , +3.2906791e-013, +3.290758e-013 , +3.2908566e-013, +3.2909751e-013, +3.291113e-013 , +3.2912708e-013, +3.2914483e-013, +3.2916457e-013, +3.2918628e-013, +3.2920997e-013, +3.2923564e-013, +3.2926326e-013, +3.2929288e-013, +3.2932449e-013, +3.293581e-013 , +3.2939366e-013, +3.2943123e-013, +3.2947077e-013, +3.295123e-013 , +3.2955583e-013, +3.2960134e-013, +3.2964885e-013, +3.2969837e-013, +3.2974987e-013, +3.2980338e-013, +3.2985889e-013, +3.2991641e-013, +3.2997593e-013, +3.3003748e-013,
			+3.3010102e-013, +3.3016659e-013, +3.3023419e-013, +3.3030379e-013, +3.303754e-013 , +3.3044907e-013, +3.3052475e-013, +3.3060249e-013, +3.3068223e-013, +3.3076403e-013, +3.3084787e-013, +3.3093377e-013, +3.3102172e-013, +3.3111171e-013, +3.3120379e-013, +3.312979e-013 , +3.3139409e-013, +3.3149235e-013, +3.3159266e-013, +3.3169509e-013, +3.3179958e-013, +3.3190616e-013, +3.3201485e-013, +3.3212563e-013, +3.3223852e-013, +3.323535e-013 , +3.324706e-013 , +3.325898e-013 , +3.3271115e-013, +3.3283462e-013, +3.3296022e-013, +3.3308797e-013,
			+3.3321786e-013, +3.3334991e-013, +3.3348408e-013, +3.3362045e-013, +3.3375898e-013, +3.3389968e-013, +3.3404255e-013, +3.3418762e-013, +3.3433488e-013, +3.3448434e-013, +3.3463599e-013, +3.3478989e-013, +3.3494599e-013, +3.3510431e-013, +3.3526486e-013, +3.3542768e-013, +3.3559272e-013, +3.3576004e-013, +3.3592961e-013, +3.3610143e-013, +3.3627555e-013, +3.3645198e-013, +3.3663068e-013, +3.3681169e-013, +3.36995e-013  , +3.3718064e-013, +3.3736859e-013, +3.3755889e-013, +3.3775156e-013, +3.3794655e-013, +3.3814393e-013, +3.3834367e-013,
			+3.3854579e-013, +3.387503e-013 , +3.3895722e-013, +3.3916655e-013, +3.3937829e-013, +3.3959248e-013, +3.3980907e-013, +3.4002816e-013, +3.4024969e-013, +3.4047369e-013, +3.4070018e-013, +3.4092913e-013, +3.4116061e-013, +3.4139461e-013, +3.4163113e-013, +3.418702e-013 , +3.4211181e-013, +3.4235597e-013, +3.4260271e-013, +3.4285205e-013, +3.4310396e-013, +3.4335851e-013, +3.4361565e-013, +3.4387543e-013, +3.4413789e-013, +3.4440297e-013, +3.4467074e-013, +3.449412e-013 , +3.4521434e-013, +3.4549021e-013, +3.457688e-013 , +3.4605015e-013,
			+3.4633424e-013, +3.4662109e-013, +3.4691073e-013, +3.4720317e-013, +3.4749842e-013, +3.477965e-013 , +3.4809745e-013, +3.4840121e-013, +3.4870788e-013, +3.4901745e-013, +3.4932991e-013, +3.4964528e-013, +3.499636e-013 , +3.5028491e-013, +3.5060914e-013, +3.509364e-013 , +3.5126665e-013, +3.5159993e-013, +3.5193625e-013, +3.5227564e-013, +3.5261808e-013, +3.5296364e-013, +3.5331232e-013, +3.5366412e-013, +3.5401909e-013, +3.5437723e-013, +3.5473856e-013, +3.551031e-013 , +3.5547089e-013, +3.558419e-013 , +3.5621622e-013, +3.5659382e-013,
			+3.5697473e-013, +3.5735897e-013, +3.577466e-013 , +3.5813759e-013, +3.58532e-013  , +3.5892982e-013, +3.5933108e-013, +3.5973581e-013, +3.6014404e-013, +3.6055582e-013, +3.609711e-013 , +3.6138998e-013, +3.6181244e-013, +3.6223851e-013, +3.6266823e-013, +3.6310161e-013, +3.6353868e-013, +3.6397946e-013, +3.6442401e-013, +3.648723e-013 , +3.6532442e-013, +3.6578035e-013, +3.6624013e-013, +3.6670382e-013, +3.6717141e-013, +3.6764293e-013, +3.6811843e-013, +3.6859792e-013, +3.6908145e-013, +3.6956901e-013, +3.700607e-013 , +3.7055648e-013,
			+3.7105643e-013, +3.7156058e-013, +3.7206894e-013, +3.7258152e-013, +3.7309842e-013, +3.7361962e-013, +3.7414519e-013, +3.7467514e-013, +3.7520949e-013, +3.7574834e-013, +3.7629166e-013, +3.7683951e-013, +3.7739194e-013, +3.7794895e-013, +3.7851062e-013, +3.7907698e-013, +3.7964805e-013, +3.8022387e-013, +3.8080452e-013, +3.8138999e-013, +3.8198034e-013, +3.8257562e-013, +3.8317589e-013, +3.8378114e-013, +3.8439144e-013, +3.8500686e-013, +3.856274e-013 , +3.8625315e-013, +3.8688413e-013, +3.8752037e-013, +3.8816194e-013, +3.8880891e-013,
			+3.8946128e-013, +3.9011914e-013, +3.9078251e-013, +3.9145147e-013, +3.9212603e-013, +3.9280628e-013, +3.9349226e-013, +3.9418403e-013, +3.9488164e-013, +3.9558512e-013, +3.9629457e-013, +3.9701001e-013, +3.9773154e-013, +3.9845918e-013, +3.9919299e-013, +3.9993304e-013, +4.0067941e-013, +4.0143214e-013, +4.0219127e-013, +4.0295694e-013, +4.0372913e-013, +4.0450794e-013, +4.0529345e-013, +4.060857e-013 , +4.0688479e-013, +4.0769078e-013, +4.0850372e-013, +4.093237e-013 , +4.1015078e-013, +4.1098508e-013, +4.1182661e-013, +4.1267545e-013,
			+4.1353173e-013, +4.1439551e-013, +4.1526683e-013, +4.1614582e-013, +4.1703257e-013, +4.1792711e-013, +4.1882955e-013, +4.1973998e-013, +4.2065849e-013, +4.2158518e-013, +4.2252012e-013, +4.234634e-013 , +4.2441511e-013, +4.2537539e-013, +4.2634429e-013, +4.2732191e-013, +4.2830838e-013, +4.2930378e-013, +4.3030821e-013, +4.3132178e-013, +4.3234459e-013, +4.3337678e-013, +4.3441842e-013, +4.3546964e-013, +4.3653056e-013, +4.3760129e-013, +4.3868194e-013, +4.3977262e-013, +4.4087349e-013, +4.4198464e-013, +4.4310622e-013, +4.4423831e-013,
			+4.4538112e-013, +4.4653471e-013, +4.4769928e-013, +4.4887491e-013, +4.5006175e-013, +4.5125996e-013, +4.5246969e-013, +4.5369107e-013, +4.5492424e-013, +4.5616939e-013, +4.5742669e-013, +4.5869623e-013, +4.5997819e-013, +4.6127278e-013, +4.6258017e-013, +4.6390046e-013, +4.6523386e-013, +4.6658055e-013, +4.6794074e-013, +4.6931458e-013, +4.7070225e-013, +4.7210396e-013, +4.7351988e-013, +4.7495027e-013, +4.7639529e-013, +4.7785511e-013, +4.7933001e-013, +4.8082019e-013, +4.8232582e-013, +4.8384717e-013, +4.8538446e-013, +4.8693796e-013,
			+4.8850783e-013, +4.9009435e-013, +4.9169772e-013, +4.9331828e-013, +4.9495624e-013, +4.9661187e-013, +4.9828544e-013, +4.9997723e-013, +5.016875e-013 , +5.0341659e-013, +5.051647e-013 , +5.0693217e-013, +5.0871931e-013, +5.1052646e-013, +5.1235389e-013, +5.1420196e-013, +5.1607102e-013, +5.1796132e-013, +5.1987332e-013, +5.2180726e-013, +5.237636e-013 , +5.257427e-013 , +5.2774489e-013, +5.2977056e-013, +5.3182019e-013, +5.3389406e-013, +5.3599269e-013, +5.3811648e-013, +5.4026586e-013, +5.4244131e-013, +5.4464322e-013, +5.4687206e-013,
			+5.491284e-013 , +5.5141265e-013, +5.5372531e-013, +5.5606697e-013, +5.5843812e-013, +5.6083924e-013, +5.63271e-013  , +5.6573393e-013, +5.6822857e-013, +5.7075552e-013, +5.7331548e-013, +5.75909e-013  , +5.7853678e-013, +5.8119948e-013, +5.8389773e-013, +5.8663231e-013, +5.8940385e-013, +5.9221318e-013, +5.95061e-013  , +5.9794812e-013, +6.0087536e-013, +6.0384353e-013, +6.0685349e-013, +6.0990606e-013, +6.1300222e-013, +6.1614277e-013, +6.1932881e-013, +6.2256125e-013, +6.2584112e-013, +6.2916941e-013, +6.3254724e-013, +6.359757e-013 ,
			+6.3945588e-013, +6.4298903e-013, +6.4657627e-013, +6.5021892e-013, +6.5391827e-013, +6.5767557e-013, +6.6149224e-013, +6.6536961e-013, +6.6930928e-013, +6.7331264e-013, +6.7738127e-013, +6.815168e-013 , +6.8572085e-013, +6.8999515e-013, +6.943415e-013 , +6.9876169e-013, +7.0325766e-013, +7.0783136e-013, +7.1248487e-013, +7.1722023e-013, +7.2203962e-013, +7.2694531e-013, +7.3193974e-013, +7.3702524e-013, +7.4220437e-013, +7.4747977e-013, +7.5285411e-013, +7.583303e-013 , +7.6391118e-013, +7.6959988e-013, +7.7539955e-013, +7.8131349e-013,
			+7.8734512e-013, +7.9349808e-013, +7.9977599e-013, +8.0618287e-013, +8.1272266e-013, +8.1939962e-013, +8.2621816e-013, +8.3318286e-013, +8.4029853e-013, +8.4757022e-013, +8.5500313e-013, +8.626028e-013 , +8.7037495e-013, +8.7832557e-013, +8.8646094e-013, +8.9478777e-013, +9.0331291e-013, +9.1204355e-013, +9.2098757e-013, +9.3015276e-013, +9.395477e-013 , +9.4918116e-013, +9.5906247e-013, +9.6920161e-013, +9.7960897e-013, +9.902953e-013 , +1.0012724e-012, +1.0125523e-012, +1.0241481e-012, +1.0360735e-012, +1.0483427e-012, +1.0609715e-012,
			+1.0739759e-012, +1.0873732e-012, +1.1011822e-012, +1.1154221e-012, +1.130114e-012 , +1.1452803e-012, +1.1609444e-012, +1.1771321e-012, +1.1938704e-012, +1.2111886e-012, +1.2291178e-012, +1.2476918e-012, +1.2669466e-012, +1.2869212e-012, +1.3076575e-012, +1.329201e-012 , +1.3516005e-012, +1.3749093e-012, +1.3991852e-012, +1.424491e-012 , +1.4508949e-012, +1.4784716e-012, +1.5073031e-012, +1.5374785e-012, +1.5690964e-012, +1.6022651e-012, +1.6371041e-012, +1.6737457e-012, +1.7123369e-012, +1.753041e-012 , +1.7960404e-012, +1.8415397e-012,
			+1.8897685e-012, +1.9409858e-012, +1.9954845e-012, +2.0535984e-012, +2.1157076e-012, +2.182249e-012 , +2.2537256e-012, +2.3307229e-012, +2.4139185e-012, +2.504113e-012 , +2.6022494e-012, +2.7094505e-012, +2.8270645e-012, +2.9567238e-012, +3.1004255e-012, +3.2606389e-012, +3.4404563e-012, +3.6438027e-012, +3.8757404e-012, +4.1429152e-012, +4.4542326e-012, +4.8219189e-012, +5.2632386e-012, +5.8034172e-012, +6.480874e-012 , +7.3572485e-012, +8.5383107e-012, +1.0222725e-011, +1.2835072e-011, +1.7486793e-011, +2.8448887e-011, +5.3749574e-011
		};

		double generate_gaussian_fast(Uint64 raw64) {//fast CDF-based hybrid method - won't produce anything more than about 6 standard deviations from the mean though
			/*
			using namespace PractRand::Tests;
			static bool initialized = false;
			static float _primary_gaussian_table[GAUSSIAN_CDF_TABLE_SIZE];
			static float _secondary_gaussian_table[GAUSSIAN_CDF_TABLE_SIZE];
			if (!initialized) {
				initialized = true;
				double scale = 1.0 / std::sqrt(3.0);
				for (long i = 0; i < GAUSSIAN_CDF_TABLE_SIZE; i++) _primary_gaussian_table[i] = math_pvalue_to_normaldist((i + 0.5) / GAUSSIAN_CDF_TABLE_SIZE) * scale;
				scale *= std::pow(0.5, 31);
				_secondary_gaussian_table[0] = (math_pvalue_to_normaldist(1.0 / GAUSSIAN_CDF_TABLE_SIZE) - math_pvalue_to_normaldist(0.5 / GAUSSIAN_CDF_TABLE_SIZE)) * scale;
				_secondary_gaussian_table[GAUSSIAN_CDF_TABLE_SIZE - 1] = (math_pvalue_to_normaldist((GAUSSIAN_CDF_TABLE_SIZE - 0.5) / GAUSSIAN_CDF_TABLE_SIZE) - math_pvalue_to_normaldist((GAUSSIAN_CDF_TABLE_SIZE - 1.0) / GAUSSIAN_CDF_TABLE_SIZE)) * scale;
				scale *= 0.5;
				for (long i = 1; i < GAUSSIAN_CDF_TABLE_SIZE - 1; i++) _secondary_gaussian_table[i] = (math_pvalue_to_normaldist((i + 1.0) / GAUSSIAN_CDF_TABLE_SIZE) - math_pvalue_to_normaldist((i + 0.0) / GAUSSIAN_CDF_TABLE_SIZE)) * scale;
				std::printf("static const float primary_gaussian_cdf_table[GAUSSIAN_CDF_TABLE_SIZE] = {\n");
				for (long i = 0; i < GAUSSIAN_CDF_TABLE_SIZE; i++) {
					if ((i % 32) == 0) std::printf("\t");
					std::printf("%+.8f, ", _primary_gaussian_table[i]);
					if ((i % 32) == 31) std::printf("\n");
				}
				std::printf("};\n");
				std::printf("static const float secondary_gaussian_cdf_table[GAUSSIAN_CDF_TABLE_SIZE] = {\n");
				for (long i = 0; i < GAUSSIAN_CDF_TABLE_SIZE; i++) {
					enum {VALUES_PER_LINE = 32};
					if ((i % VALUES_PER_LINE) == 0) std::printf("\t");
					std::printf("%+.8g, ", _secondary_gaussian_table[i]);
					if ((i % VALUES_PER_LINE) == VALUES_PER_LINE-1) std::printf("\n");
				}
				std::printf("};\n");
			}
			//*/

			Sint32 si = Sint32(raw64 >> 32);
			Uint32 indeces = Uint32(raw64);
			long index;
			index = (indeces >> (GAUSSIAN_CDF_TABLE_SIZE_L2 * 0)) & (GAUSSIAN_CDF_TABLE_SIZE - 1);
			double rv = primary_gaussian_cdf_table[index];
			rv += si * secondary_gaussian_cdf_table[index];
			index = (indeces >> (GAUSSIAN_CDF_TABLE_SIZE_L2 * 1)) & (GAUSSIAN_CDF_TABLE_SIZE - 1);
			rv += primary_gaussian_cdf_table[index];
			index = (indeces >> (GAUSSIAN_CDF_TABLE_SIZE_L2 * 2)) & (GAUSSIAN_CDF_TABLE_SIZE - 1);
			rv += primary_gaussian_cdf_table[index];
			return rv;
		}
		double generate_gaussian_high_quality(Uint64 a, Uint64 b, Uint64 c) {//slower, more exact method
			using namespace PractRand::Tests;
			/*
			double rv = count_bits64(a) + count_bits64(c) + (1.0 / 4294967296) * ((b >> 32) + Uint32(b));
			rv -= 65;
			//rv /= std::sqrt(0.5 * 0.5 * 128 + 2 * 1.0 / 12);
			rv *= 0.1763181298152700011931630279543;
			return rv;
			//*/

			//*
			double rv = count_bits64(a) - 32;
			//rv += (1.0 / 4294967296) * ((b >> 32) + Uint32(b)) - 1;
			rv += generate_gaussian_fast(b) * 0.5;
			//rv += generate_gaussian_fast(c);
			static const double scale = 1.0 / std::sqrt(0.5 * 0.5 * 64 + 0.5);
			rv *= scale;
			//rv *= 0.24135539601273889774006430052989;
			return rv;
			//*/

			/*double rv = generate_gaussian_fast(a) + generate_gaussian_fast(b) + generate_gaussian_fast(c);
			rv *= 0.57735026918962576450914878050196;
			return rv;*/
		}
	}
}
